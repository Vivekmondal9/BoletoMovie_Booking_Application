{"ast":null,"code":"var _s = $RefreshSig$();\n// Replace with your actual API base URL\n\nimport { useNavigate } from \"react-router\";\nasync function fetchWithToken(url, options = {}) {\n  _s();\n  let nav = useNavigate();\n  const token = localStorage.getItem('access_token'); // Get token from local storage\n\n  // If token is available, add it to the request headers\n  if (token) {\n    options.headers = {\n      ...options.headers,\n      Authorization: `Bearer ${token}`\n    };\n  }\n  const response = await fetch(`${url}`, options);\n  // Check if token expired\n  if (response.status === 401) {\n    const refreshToken = localStorage.getItem('refresh_token'); // Get refresh token from local storage\n    if (refreshToken) {\n      // Fetch new access token using refresh token\n      const refreshResponse = await fetch(`http://127.0.0.1:8000/api/refresh/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          refresh_token: refreshToken\n        })\n      });\n      console.log(refreshResponse);\n      if (refreshResponse.ok) {\n        const data = await refreshResponse.json();\n        localStorage.setItem('access_token', data.access_token);\n        return fetchWithToken(url, options);\n      } else {\n        localStorage.removeItem(\"access_token\");\n        localStorage.removeItem(\"refresh_token\");\n      }\n    }\n  }\n  return response;\n}\n_s(fetchWithToken, \"1lJpW1ZyBjjoZdLGgRu75VwkrM8=\", false, function () {\n  return [useNavigate];\n});\nexport { fetchWithToken };","map":{"version":3,"names":["useNavigate","fetchWithToken","url","options","_s","nav","token","localStorage","getItem","headers","Authorization","response","fetch","status","refreshToken","refreshResponse","method","body","JSON","stringify","refresh_token","console","log","ok","data","json","setItem","access_token","removeItem"],"sources":["/Users/vivekmondal/Desktop/Final_Exam_Coding_Invaders/boletomovie/src/API/interceptor.js"],"sourcesContent":["// Replace with your actual API base URL\n\nimport { useNavigate } from \"react-router\";\n\nasync function fetchWithToken(url, options = {}) {\n\n    let nav=useNavigate()\n    const token = localStorage.getItem('access_token'); // Get token from local storage\n\n    // If token is available, add it to the request headers\n    if (token) {\n        options.headers = {\n            ...options.headers,\n            Authorization: `Bearer ${token}`,\n        };\n    }\n\n    const response = await fetch(`${url}`, options);\n    // Check if token expired\n    if (response.status === 401) {\n        const refreshToken = localStorage.getItem('refresh_token'); // Get refresh token from local storage\n        if (refreshToken) {\n            // Fetch new access token using refresh token\n            const refreshResponse = await fetch(`http://127.0.0.1:8000/api/refresh/`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ refresh_token: refreshToken }),\n            })\n            \n            console.log(refreshResponse);\n\n            if (refreshResponse.ok) {\n                const data = await refreshResponse.json();\n                localStorage.setItem('access_token', data.access_token);\n                return fetchWithToken(url, options);\n            } else {\n                localStorage.removeItem(\"access_token\");\n                localStorage.removeItem(\"refresh_token\");\n            }\n        }\n    }\n\n    return response;\n}\n\nexport { fetchWithToken };"],"mappings":";AAAA;;AAEA,SAASA,WAAW,QAAQ,cAAc;AAE1C,eAAeC,cAAcA,CAACC,GAAG,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;EAAAC,EAAA;EAE7C,IAAIC,GAAG,GAACL,WAAW,CAAC,CAAC;EACrB,MAAMM,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC;;EAEpD;EACA,IAAIF,KAAK,EAAE;IACPH,OAAO,CAACM,OAAO,GAAG;MACd,GAAGN,OAAO,CAACM,OAAO;MAClBC,aAAa,EAAG,UAASJ,KAAM;IACnC,CAAC;EACL;EAEA,MAAMK,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEV,GAAI,EAAC,EAAEC,OAAO,CAAC;EAC/C;EACA,IAAIQ,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;IACzB,MAAMC,YAAY,GAAGP,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC;IAC5D,IAAIM,YAAY,EAAE;MACd;MACA,MAAMC,eAAe,GAAG,MAAMH,KAAK,CAAE,oCAAmC,EAAE;QACtEI,MAAM,EAAE,MAAM;QACdP,OAAO,EAAE;UACL,cAAc,EAAE;QACpB,CAAC;QACDQ,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEC,aAAa,EAAEN;QAAa,CAAC;MACxD,CAAC,CAAC;MAEFO,OAAO,CAACC,GAAG,CAACP,eAAe,CAAC;MAE5B,IAAIA,eAAe,CAACQ,EAAE,EAAE;QACpB,MAAMC,IAAI,GAAG,MAAMT,eAAe,CAACU,IAAI,CAAC,CAAC;QACzClB,YAAY,CAACmB,OAAO,CAAC,cAAc,EAAEF,IAAI,CAACG,YAAY,CAAC;QACvD,OAAO1B,cAAc,CAACC,GAAG,EAAEC,OAAO,CAAC;MACvC,CAAC,MAAM;QACHI,YAAY,CAACqB,UAAU,CAAC,cAAc,CAAC;QACvCrB,YAAY,CAACqB,UAAU,CAAC,eAAe,CAAC;MAC5C;IACJ;EACJ;EAEA,OAAOjB,QAAQ;AACnB;AAACP,EAAA,CAzCcH,cAAc;EAAA,QAEjBD,WAAW;AAAA;AAyCvB,SAASC,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}